(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[313],{8834:function(e,l,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/apps/[id]/score",function(){return s(8626)}])},8626:function(e,l,s){"use strict";s.r(l);var t=s(4051),i=s.n(t),n=s(5893),r=s(7294),a=s(1163),o=s(5797),c=s(4931),d=s(2856),x=s(2429),m=s(8111),v=s(5163);function u(e,l,s,t,i,n,r){try{var a=e[n](r),o=a.value}catch(c){return void s(c)}a.done?l(o):Promise.resolve(o).then(t,i)}l.default=function(){var e,l,s,t,p,f,h,j,N,b,w,g,y,_=(0,a.useRouter)(),k=(0,m.JJ)().params,C=(0,m.qD)(),E=C.user,L=C.setUser,P=(0,m.Cm)().setLoading,S=(0,m.U3)(),Z=S.isNav,T=S.setNav,q=(0,r.useState)(!1),A=q[0],U=q[1];(0,x.N4)();var D,J,M=0,O=0,X="",B="";return D=10*(null===k||void 0===k||null===(e=k.score)||void 0===e?void 0:e.time)+(null===k||void 0===k||null===(l=k.score)||void 0===l?void 0:l.centimes),J=(M=((M=3e3-D-300*(null===k||void 0===k||null===(s=k.score)||void 0===s?void 0:s.skip)-50*(null===k||void 0===k||null===(t=k.score)||void 0===t?void 0:t.missTap))<0?0:M)+100).toLocaleString(),E&&((O=E.level_point+M)>9999&&(O-=1e4),X="".concat(Math.floor(O/1e4*200),"px"),B="".concat(O<E.level_point?0:Math.floor(E.level_point/1e4*200),"px")),(0,r.useEffect)((function(){var e;Z?(P(!0),(e=i().mark((function e(){var l,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E){e.next=7;break}return L({id:E.id,name:E.name,icon:E.icon,level:O<E.level_point?E.level+1:E.level,level_point:O,play_time:E.play_time+(null===k||void 0===k?void 0:k.score.time),clear_times:E.clear_times+1,title:E.title,email:E.email}),e.next=5,(0,v.VZ)(v.EP.appScore(String(null===(l=_.query)||void 0===l?void 0:l.id)),{score:M,level:E.level_point?E.level+1:E.level,levelPoint:O,playTime:Number(E.play_time)+(null===k||void 0===k?void 0:k.score.time),clearTimes:Number(E.clear_times)+1});case 5:(s=e.sent.err)?401===s.status?U("401"):c.ZP.error(s.data.message):(U(!0),T(!1));case 7:P(!1);case 8:case"end":return e.stop()}}),e)})),function(){var l=this,s=arguments;return new Promise((function(t,i){var n=e.apply(l,s);function r(e){u(n,t,i,r,a,"next",e)}function a(e){u(n,t,i,r,a,"throw",e)}r(void 0)}))})()):E&&U(!0)}),[]),(0,n.jsxs)("div",{className:"bg-white flex items-center justify-around relative rounded-md shadow-sm mb-5 w-full",children:[(0,n.jsxs)("div",{className:"bg-white flex items-center absolute top-[-25px] left-[-10px] rounded-lg py-2 px-4 shadow-md",children:[(0,n.jsx)("img",{src:null===k||void 0===k||null===(p=k.game)||void 0===p?void 0:p.icon,className:"w-10"}),(0,n.jsx)("p",{className:"font-bold text-xl ml-3",children:null===k||void 0===k||null===(f=k.game)||void 0===f?void 0:f.name})]}),(0,n.jsxs)("div",{className:"flex flex-col p-10 w-full items-center",children:[(0,n.jsxs)("div",{className:"flex items-baseline my-2 ",children:[(0,n.jsx)("p",{className:"w-36 text-right mr-5",children:"\u30bf\u30a4\u30e0"}),(0,n.jsxs)("div",{className:"flex w-32 justify-end",children:[(0,n.jsxs)("p",{className:"font-bold text-2xl mr-2",children:[null===k||void 0===k||null===(h=k.score)||void 0===h?void 0:h.time,".",null===k||void 0===k||null===(j=k.score)||void 0===j?void 0:j.centimes]}),(0,n.jsx)("p",{className:"font-normal text-2xl",children:"s"})]}),(0,n.jsxs)("p",{className:"text-[#25984C] text-xl font-bold w-44 text-right",children:["+ ",3e3-D<0?0:(3e3-D).toLocaleString()]})]}),(0,n.jsxs)("div",{className:"flex items-baseline my-2 ",children:[(0,n.jsx)("p",{className:"text-[#888] w-36 text-right mr-5",children:"\u30b9\u30ad\u30c3\u30d7"}),(0,n.jsxs)("div",{className:"flex w-32 justify-end",children:[(0,n.jsx)("p",{className:"font-bold text-xl text-[#555] mr-2",children:null===k||void 0===k||null===(N=k.score)||void 0===N?void 0:N.skip}),(0,n.jsx)("p",{className:"text-[#888]",children:"\u56de"})]}),(0,n.jsxs)("p",{className:"text-[#AE2E5C] text-xl font-bold w-44 text-right",children:["\u25b2 ",(300*(null===k||void 0===k||null===(b=k.score)||void 0===b?void 0:b.skip)).toLocaleString()]})]}),(0,n.jsxs)("div",{className:"flex items-baseline my-2",children:[(0,n.jsx)("p",{className:"text-[#888] w-36 text-right mr-5",children:"\u30df\u30b9\u30bf\u30c3\u30d7"}),(0,n.jsxs)("div",{className:"flex w-32 justify-end",children:[(0,n.jsx)("p",{className:"font-bold text-xl text-[#555] mr-2",children:null===k||void 0===k||null===(w=k.score)||void 0===w?void 0:w.missTap}),(0,n.jsx)("p",{className:"text-[#888]",children:"\u56de"})]}),(0,n.jsxs)("p",{className:"text-[#AE2E5C] text-xl font-bold w-44 text-right",children:["\u25b2 ",50*(null===k||void 0===k||null===(g=k.score)||void 0===g?void 0:g.missTap)]})]}),(0,n.jsx)("div",{className:"border-solid border-b-[0.5px] border-gray-100 w-3/5"}),(0,n.jsxs)("div",{className:"flex items-baseline my-2",children:[(0,n.jsx)("p",{className:"text-[#888] w-36 text-right mr-5",children:"\u30c8\u30fc\u30bf\u30eb"}),(0,n.jsx)("div",{className:"flex w-32 justify-end",children:(0,n.jsx)("p",{className:"font-bold text-xl text-[#555] mr-2",children:"-"})}),(0,n.jsx)("p",{className:"text-[#25984C] text-xl font-bold w-44 text-right",children:(M-100).toLocaleString()})]}),(0,n.jsxs)("div",{className:"flex items-baseline my-2",children:[(0,n.jsx)("p",{className:"text-[#888] w-36 text-right mr-5",children:"\u30af\u30ea\u30a2\u30dc\u30fc\u30ca\u30b9"}),(0,n.jsx)("div",{className:"flex w-32 justify-end",children:(0,n.jsx)("p",{className:"font-bold text-xl text-[#555] mr-2",children:"-"})}),(0,n.jsx)("p",{className:"text-[#25984C] text-xl font-bold w-44 text-right",children:"+ 100"})]}),(0,n.jsxs)("div",{className:"flex items-baseline my-2 w-4/5 justify-around",children:[E&&!0===A&&(0,n.jsxs)("div",{className:"flex items-baseline",children:[(0,n.jsx)("p",{className:"text-md text-[#555] mr-2",children:"\u30d9\u30b9\u30c8\u30b9\u30b3\u30a2"}),(0,n.jsx)("p",{className:"text-xl font-bold text-[#777]",children:null===k||void 0===k||null===(y=k.bestScore)||void 0===y?void 0:y.toLocaleString()})]}),(0,n.jsxs)("div",{className:"flex items-baseline",children:[(0,n.jsx)("p",{className:"text-lg font-bold mr-2",children:"\u4eca\u56de\u306e\u30b9\u30b3\u30a2"}),(0,n.jsx)("p",{className:"text-3xl font-bold",children:J})]})]}),(0,n.jsx)("div",{className:"border-solid border-b-[0.5px] border-[#1C73BD] w-4/5 my-4"}),E&&!0===A?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center w-2/3 mt-5",children:[(0,n.jsxs)("div",{className:"flex items-baseline w-1/2",children:[(0,n.jsx)("p",{className:"text-ls mr-4",children:"Point"}),(0,n.jsxs)("p",{className:"text-xl font-bold",children:["+ ",J]})]}),O<E.level_point&&(0,n.jsxs)("div",{className:"flex text-[#e24413] items-center",children:[(0,n.jsx)("h3",{children:"Level UP"}),(0,n.jsx)(o.ZA3,{})]}),(0,n.jsxs)("p",{className:"font-bold text-xl",children:["Lv. ",O<E.level_point?E.level+1:E.level]})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center w-2/3 mt-5",children:[(0,n.jsx)("div",{className:"relative border-solid border-2 w-[200px] h-[36px] rounded-sm",children:(0,n.jsx)("div",{className:"relative h-[32px] bg-gradient-to-b from-[#333] to-[#888]",children:(0,n.jsx)("div",{className:"h-[32px] bg-gradient-to-b from-[#90bbe0] to-[#347dbd]",style:{width:X},children:(0,n.jsx)("div",{className:"h-[32px] bg-gradient-to-b from-[#5387b4] to-[#1c3f5e]",style:{width:B}})})})}),(0,n.jsxs)("span",{className:"flex items-baseline",children:["\u6b21\u306eLv\u307e\u3067",(0,n.jsx)("p",{className:"font-bold text-xl mx-2",children:(1e4-O).toLocaleString()}),"Point"]})]})]}):E?"401"===A&&(0,n.jsx)("div",{className:"flex flex-col text-[#555] my-3",children:(0,n.jsx)("p",{children:"\u30ed\u30b0\u30a4\u30f3\u671f\u9650\u304c\u5207\u308c\u3066\u3044\u307e\u3059\u3002\u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\u3002"})}):(0,n.jsx)("div",{className:"flex flex-col text-[#555] my-3",children:(0,n.jsx)("p",{children:"\u4f1a\u54e1\u767b\u9332\u3059\u308b\u3068\u30e9\u30f3\u30ad\u30f3\u30b0\u6a5f\u80fd\u30fb\u30d7\u30ec\u30a4\u30e4\u30fc\u30ec\u30d9\u30eb\u6a5f\u80fd\u3092\u5229\u7528\u3067\u304d\u307e\u3059\u3002"})}),(0,n.jsxs)("div",{className:"flex mt-10 w-full justify-around",children:[(0,n.jsx)(d.Z,{type:"outlined",text:"\u30a2\u30d7\u30ea\u9078\u629e",onClick:function(){return _.replace("/apps")}}),(0,n.jsx)(d.Z,{type:"outlined",text:"\u3082\u3046\u4e00\u5ea6\u30d7\u30ec\u30a4",onClick:function(){var e;return _.replace("/apps/".concat(null===(e=_.query)||void 0===e?void 0:e.id))}}),E&&!0===A?(0,n.jsx)(d.Z,{type:"contained",text:"\u30e9\u30f3\u30ad\u30f3\u30b0\u78ba\u8a8d",onClick:function(){var e;return _.replace("/apps/".concat(null===(e=_.query)||void 0===e?void 0:e.id,"/ranking"))}}):E?"401"===A&&(0,n.jsx)(d.Z,{type:"contained",text:"\u30ed\u30b0\u30a4\u30f3",onClick:function(){return _.replace("/login")}}):(0,n.jsx)(d.Z,{type:"contained",text:"\u4f1a\u54e1\u767b\u9332",onClick:function(){return _.replace("/register")}})]})]}),(0,n.jsx)(c.x7,{position:"bottom-center"})]})}}},function(e){e.O(0,[885,314,630,931,669,218,205,774,888,179],(function(){return l=8834,e(e.s=l);var l}));var l=e.O();_N_E=l}]);